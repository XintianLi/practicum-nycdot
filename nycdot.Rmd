---
title: "NYCDOT"
author: "Jiaxuan Lyu, Kate Sutton, Xintian Stella Li"
date: "1/31/2021"
output: rmarkdown::github_document
---
## Set up the boxr api
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# install.packages('boxr')
library(boxr)
library(tidyverse)
library(sf)
library(lubridate)
library(data.table)
library(RPostgreSQL)
```

```{r set up 2}
box_auth(client_id = "nnlfdm85tbwa6vb5tgauczwed3rciavx", 
         client_secret = "S8B3zjkOm7xipOb0JZjgX5gu1i9tnPfo")

```

```{r echo=FALSE}
box_getwd()
box_ls()
box_setwd(130657584748)
# dat <- box_read(771482435266)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.




#Visualization
```{r vispackage}
library(tidyverse)
library(sf)
library(lubridate)
```

#Used 2018 ride data in April

```{r loaddata}
rideApr <- st_read("E:/NYCDOT/RideInsights_trim/ride2018Apr/ride2018Apr_sf.shp")

#add time
rideApr <- rideApr %>%
  mutate(time = ymd_hms(rcrd_tm)) %>%
  mutate(rhour = hour(time)) %>%
  mutate(days = substr(rdate, 9, 10))
```


```{r vis1}
#trips by days
ggplot()+
  geom_sf(data = rideApr) +
  facet_wrap(~days)

#trips by hours in one day
ggplot()+
  geom_sf(data = rideApr %>%
            filter(days == "01")) +
  facet_wrap(~rhour)
```


```{r vis2}
#change days as numeric
rideApr$days <- as.numeric(rideApr$days)

#trips over days
ggplot(rideApr %>%
       as.data.frame() %>%
       group_by(days) %>%
       tally())+
  geom_line(aes(x = days, y = n))

#trips over hour
ggplot(rideApr %>%
         as.data.frame() %>%
         group_by(rhour) %>%
         tally())+
  geom_line(aes(x = rhour, y = n))
```
